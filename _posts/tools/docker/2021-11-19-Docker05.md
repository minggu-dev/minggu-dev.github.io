---
layout: post
title:  "Dockerfile개념 및 작성법1"
date:   2021-11-19 10:55:18 +0900
categories: Tools
tags: Docker
---
# Introduction
<hr>

![소개 글 이미지](/img/tools/Docker/docker-logo.png)
>
#### 지난 글에서 `docker run`명령어의 다양한 옵션과 그 사용법에 대하여 알아 보았다. 이번 글에서는 도커 실행시 더 편하게 사용할 수 있도록 도와주는 Dockerfile에 대하여 알아보도록 하겠다.

<br>
<br>



# Dockerfile이란?
<hr>

이전까지 배운 내용으로 도커를 실행하기 위해서는 docker hub에서 이미지를 다운받아 컨테이너를 생성하고 해당 컨테이너 안에서 사용하고자 하는 파일을 생성하는 과정을 진행했어야 한다. 그러나 매번 컨테이너를 생성하고 사용하려는 파일을 생성하고 환경설정을 바꾸는 과정을 반복하는 것은 매우 비효율적이라는 것은 쉽게 알 수 있을 것이다. 이러한 문제를 해결할 수 있도록 도와주는 것이 바로 Dockerfile이다.

Dockerfile은 컨테이너에 설치해야하는 패키지나 환경변수설정 내용 등을 기록한 파일이며 이 파일을 통해 새로운 이미지를 생성할 수 있고 이를 통해 매번 번거로운 과정을 통하지 않고 같은 환경의 컨테이너를 생성할 수 있게 된다.

물론 컨테이너를 생성 후 작업을 하고 난 후 그 컨테이너를 커밋하여 현재의 상태를 이미지화 하는 방법도 있지만 Dockerfile을 이용하여 이미지화 하는것을 권장한다. 그 이유로는 패키지 설치를 명확히 해주고, 이미지 생성도 자동으로 되기 때문에 간편하고 베포하기 쉽다는 것이 있다.

<br>
<br>

# Dockerfile 작성법
<hr>

기본적으로 `명령어 인수`의 형태를 취하고 주석을 달고싶다면 #을 붙여주면 된다. 참고로 명령어의 대소문자 구분은 없다.
Dockerfile에서 사용하는 주요 명령어는 다음과 같다.

|명령어|설명|
|:---:|:---|
|FROM|생성할 이미지의 베이스가 될 이미지를 뜻한다. 반드시 한번 이상 입력해야 한다.|
|LABEL|이미지에 메타데이터를 추가한다. (나중에 원하는 조건의 컨테이너, 이미지 등을 쉽게 찾을 수 있도록 도와주기 때문에 기억해두는게 좋다.)|
|RUN|이미지를 만들기 위해 컨테이너 내부에서 명령어를 실행힌다. ["/bin/bash", "-c", "echo hello > test2.html"] => /bin/bash 셸을 이용해 echo hello > test2.html를 실행하라는 뜻이다.|
|ADD|파일을 이미지에 추가한다.|
|COPY|파일을 복사한다.|
|WORKDIR|명령어를 실행할 디렉토리. 배시 셸에서의 cd 명령어와 동일한 기능을 한다.|
|EXPOSE|이미지에서 노출할 포트를 설정한다.|
|CMD|컨테이너가 시작될 때마다 실행할 명령어. Dockerfile에서 한번만 사용할 수 있다.|
|ENV|생성할 이미지의 환경변수를 설정한다.|
|VOLUME|호스트의 경로를 컨테이너의 경로에 마운트한다. `run`명령어에서 `-v`옵션을 생각하면 된다.|
|USER|사용자를 지정한다.|
|ARG|Dockerfile 안의 변수들|
|ONBUILD|빌드가 완료된 후 실행되는 명령어이다.|
|STOPSIGNAL|시스템 콜 시그널 설정|
|SHELL|기본 쉘 설정|

이러한 명령어들을 확장자 없이 `Dockerfile`이라는 이름으로 작성하면 된다. 물론 `Dockerfile` 이외의 이름도 지을 수 있으나 그렇게하면 빌드시에 파일명을 명시해야한다.

Dockerfile을 작성했다면 이를 빌드해야하는데 그 명령어는 다음과 같다.

`docker build -t [생성할 이미지 이름]:[태그명] -f [dockerfile 파일명] [dockerfile 위치]`

태그명은 없어도 무관하고 Dockerfile의 파일명을 별도로 짓지 않았으면 파일명도 지정하지 않아도 된다.

<br>
<br>



# 마무리
<hr>

#### 이번글에서는 Dockerfile의 개념에 대해 알아보고 Dockerfile의 작성법에 대해 간단히 알아보았다. 다음글에서는 직접 Dockerfile을 작성하여 빌드를 진행해보고 생성된 이미지로 컨테이너를 실행시키는 작업을 해보도록 하겠다.



<br>
<br>
<br>
<br>






**이제 막 알아가는 단계인 초보이므로 오류나 잘못된 점이 있다면 지적해주시면 감사합니다! 🥰**
